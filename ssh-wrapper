# wrap ssh to aid in tmux splits
function ssh() {

  # if tmux is running
  if [ -n "$TMUX" ]
  then
    window_index=$(tmux display-message -p '#I')
    session_variable_name="window_${window_index}_ssh_command"
    
    tmux setenv $session_variable_name "$*"

    # run ssh
    /usr/bin/ssh $*

    # clean up
    #rm $TMUX.ssh
  else
    # just run
    /usr/bin/ssh $*
  fi
}

function tmux_ssh_split() {
  ssh_options=$(tmux showenv | grep "ssh_command" | sed 's/^.*=//')
  if [ -n "$ssh_options" ]
  then
    tmux splitw $1 "exec ssh $ssh_options"
  else
    tmux splitw $1
  fi
}
